<html>
<head> 


</head>
<body> 
<canvas id="canvas" style="width:800; height:600; border: 1px solid black;">  Canvas nie działa </canvas>

<script type="text/javascript" src="animation.js"></script>
<script type="text/javascript"> 





window.onload = function() {



var myAnimation = new Animation("canvas");
       var canvas = myAnimation.getCanvas();
                var context = myAnimation.getContext();
                
                var linearSpeed = 200; // pikseli / sekundę
                var createBall = function(){
                	this.x = canvas.width / 2;
                	this.y = canvas. height / 2;
                	this.radius = 10;
                	this.yInverse = Math.floor(Math.random() * 2);
                	this.xInverse = Math.floor(Math.random() * 2);
                    this.collision = 1.8;
                	//this.colors = ["red", "green", "blue", "black", "grey"];
                	this.color = "black"//this.colors[Math.floor(Math.random() * 5)];
                	this.drawMe = function(Animation, linearDistEachFrame) {
                		
                        

                        //określa czy piłka uderzyła w rakietkę
                		if(Math.round(this.y) >= rocket.y && Math.round(this.y) <= rocket.y + rocket.height && Math.round(this.x / 10) * 10 == rocket.x + rocket.width) 
                			{
                                //jeśli uderzyła w górną lub w dolną część odwraca tor lotu piłki i określa kierunek po kolizji
                				this.xInverse = false;
                                
                				if(Math.round(this.y) >= rocket.y && Math.round(this.y) < rocket.y + rocket.height / 2 )
                				{
                        
                                    this.collision = (2 / (rocket.height / 2)) * (this.y - rocket.y);
                					this.yInverse = true;
                				}
                				else if(Math.round(this.y) > rocket.y + rocket.height / 2 && Math.round(this.y) <= rocket.y + rocket.height)
                				{
                                    
                                    this.collision = (2 / (rocket.height / 2)) * (rocket.height / 2-(this.y - rocket.y - rocket.height / 2)) ;
                					this.yInverse = false;
                				}
                                //ustawia maksymalny kierunek nie mniejszy niż 1
                                if(this.collision < 1) this.collision = 1;
                				
                			}
                        else if(Math.round(this.x) < this.radius) myAnimation.stop();
                              
                            
                        
                	   	/////////////////////////////////
                	   	//////Rakieta 2
                		if(Math.round(this.y) >= rocket_2.y && Math.round(this.y) <= rocket_2.y + rocket_2.height && Math.round(this.x / 10) * 10 == rocket_2.x)
                			{
                                //jeśli uderzyła w górną lub w dolną część odwraca tor lotu piłki i określa kierunek po kolizji
                				this.xInverse = true;
                               
                				if(Math.round(this.y) >= rocket_2.y && Math.round(this.y) < rocket_2.y + rocket_2.height / 2 )
                				{
                        
                                    this.collision = (2 / (rocket_2.height / 2)) * (this.y - rocket_2.y);
                					this.yInverse = true;
                				}
                				else if(Math.round(this.y) > rocket_2.y + rocket_2.height / 2 && Math.round(this.y) <= rocket_2.y + rocket_2.height)
                				{
                                    
                                    this.collision = (2 / (rocket_2.height / 2)) * (rocket_2.height / 2-(this.y - rocket_2.y - rocket_2.height / 2)) ;
                					this.yInverse = false;
                				}
                                //ustawia maksymalny kierunek nie mniejszy niż 1
                                if(this.collision < 1) this.collision = 1;
                				
                			}
                		else {
                            if(Math.round(this.x) >= canvas.width - this.radius) myAnimation.stop();  
                            
                        } 
		                
                		///////////////////////////////////////	
		                if(Math.round(this.y) >= canvas.height - this.radius) this.yInverse = true; 
		                else if(Math.round(this.y) <= this.radius) this.yInverse = false;

                        if (this.xInverse == false) {
                            this.x += linearDistEachFrame * this.collision;
                            
                            if (this.yInverse == false) {
                                this.y += linearDistEachFrame * (2 - this.collision);
                            }
                            else {
                                this.y -= linearDistEachFrame * (2 - this.collision);
                            }
	                    } 
	                    else {
	                    	this.x -= linearDistEachFrame * this.collision;
                            
                            if (this.yInverse == false) {
                                this.y += linearDistEachFrame * (2 - this.collision);
                            }
                            else {
                                this.y -= linearDistEachFrame * (2 - this.collision);
                            }
	                    }

	                   
	                    		
	               

	                    
	                    context.beginPath();
	                    context.fillStyle = this.color;
	                    context.arc(this.x, this.y, this.radius, 0, 2 * Math.PI,false);
	                    context.fill();
                	};
                };

                var rocket = {
                	x: 0,
                	y: canvas.height / 2 - 50,
                	width: 10,
                	height: 100,
                	distance: 50, //per sec
                	draw: function(){
                		context.fillStyle = "black";
                		context.fillRect(this.x, this.y, this.width, this.height);
                	}

                }

                var rocket_2 = {
                	x: canvas.width - 10,
                	y: canvas.height / 2 - 50,
                	width: 10,
                	height: 100,
                	distance: 50, //per sec
                	draw: function(){
                		context.fillStyle = "black";
                		context.fillRect(this.x, this.y, this.width, this.height);
                	}
                }

             

                document.addEventListener('keydown', function(){
					var key_press = String.fromCharCode(event.keyCode);
						
					if(rocket.y + rocket.height > canvas.height) rocket.y = canvas.height - rocket.height;
					else if(rocket.y < 0) rocket.y = 0;	
						
					if(key_press == "S" && rocket.y + rocket.height < canvas.height) 
						{

							for(var i = 1; i < 31 ; i++)
							{
								setTimeout(function() {
									rocket.y+= rocket.distance / 30;
									
								}, 2 * i);
							}

						}
					else if(key_press == "W" && rocket.y > 0) 
						{
							for(var i = 1; i < 31 ; i++)
							{
								setTimeout(function() {
									rocket.y-= rocket.distance / 30;
									
								}, 2 * i);
							}

						}

					});

                document.addEventListener('keydown', function(){
					
						
					if(rocket_2.y + rocket_2.height > canvas.height) rocket_2.y = canvas.height - rocket_2.height;
					else if(rocket_2.y < 0) rocket_2.y = 0;	
					
					if(event.keyCode == 40 && rocket_2.y + rocket_2.height < canvas.height) 
						{

							for(var i = 1; i < 31 ; i++)
							{
								setTimeout(function() {
									rocket_2.y+= rocket_2.distance / 30;
									
								}, 2 * i);
							}

						}
					else if(event.keyCode == 38 && rocket.y > 0) 
						{
							for(var i = 1; i < 31 ; i++)
							{
								setTimeout(function() {
									rocket_2.y-= rocket_2.distance / 30;
									
								}, 2 * i);
							}

						}

					});

                var ball = new createBall();;

                myAnimation.setDrawStage(function(){
                    // aktualizacja
                    var linearDistEachFrame = linearSpeed * this.getTimeInterval() / 1000;

                  		myAnimation.clear();

                  		rocket.draw();
                  		rocket_2.draw();

                  		ball.drawMe(myAnimation, linearDistEachFrame);

                });

           
                myAnimation.start();
            };





</script>


</body>

</html>